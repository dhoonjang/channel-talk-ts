{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["export type IWindow = typeof window & {\n  ChannelIO: any;\n  ChannelIOInitialized: boolean;\n  attachEvent: any;\n};\n\nexport interface IChannelServiceSetting {\n  pluginKey: string;\n  customLauncherSelector?: string;\n  hideChannelButtonOnBoot?: boolean;\n  profile?: {\n    name: string;\n    mobileNumber: string;\n  };\n}\n\nclass ChannelService {\n  constructor() {\n    this.loadScript();\n  }\n\n  loadScript() {\n    let chanelWindow: IWindow = window as IWindow;\n\n    if (chanelWindow.ChannelIO) {\n      return (window.console.error || window.console.log || function () {})(\n        \"ChannelIO script included twice.\"\n      );\n    }\n\n    let ch: any = function () {\n      ch.c(arguments);\n    };\n\n    ch.q = [];\n    ch.c = function (args: any) {\n      ch.q.push(args);\n    };\n    chanelWindow.ChannelIO = ch;\n\n    function load() {\n      if (chanelWindow.ChannelIOInitialized) return;\n\n      chanelWindow.ChannelIOInitialized = true;\n      let s = document.createElement(\"script\");\n      s.type = \"text/javascript\";\n      s.async = true;\n      s.src = \"https://cdn.channel.io/plugin/ch-plugin-web.js\";\n      s.charset = \"UTF-8\";\n      let x = document.getElementsByTagName(\"script\")[0];\n      x.parentNode?.insertBefore(s, x);\n    }\n\n    if (document.readyState === \"complete\") {\n      load();\n    } else if (chanelWindow.attachEvent) {\n      chanelWindow.attachEvent(\"onload\", load);\n    } else {\n      window.addEventListener(\"DOMContentLoaded\", load, false);\n      window.addEventListener(\"load\", load, false);\n    }\n  }\n\n  boot(\n    settings: IChannelServiceSetting,\n    callback?: (error: Error, user: any) => void\n  ) {\n    const { ChannelIO }: IWindow = window as IWindow;\n    ChannelIO(\"boot\", settings, callback);\n  }\n\n  hideMessenger() {\n    const { ChannelIO }: IWindow = window as IWindow;\n    ChannelIO(\"hideMessenger\");\n  }\n\n  showMessenger() {\n    const { ChannelIO }: IWindow = window as IWindow;\n    ChannelIO(\"showMessenger\");\n  }\n\n  openChat(chatId: number) {\n    const { ChannelIO }: IWindow = window as IWindow;\n    ChannelIO(\"openChat\", chatId);\n  }\n\n  shutdown() {\n    const { ChannelIO }: IWindow = window as IWindow;\n    ChannelIO(\"shutdown\");\n  }\n}\n\nexport default new ChannelService();\n"],"names":[],"mappings":";;;;AAgBA;IACE;QACE,IAAI,CAAC,UAAU,EAAE,CAAC;KACnB;IAED,mCAAU,GAAV;QACE,IAAI,YAAY,GAAY,MAAiB,CAAC;QAE9C,IAAI,YAAY,CAAC,SAAS,EAAE;YAC1B,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,IAAI,MAAM,CAAC,OAAO,CAAC,GAAG,IAAI,eAAc,EAClE,kCAAkC,CACnC,CAAC;SACH;QAED,IAAI,EAAE,GAAQ;YACZ,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;SACjB,CAAC;QAEF,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC;QACV,EAAE,CAAC,CAAC,GAAG,UAAU,IAAS;YACxB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACjB,CAAC;QACF,YAAY,CAAC,SAAS,GAAG,EAAE,CAAC;QAE5B,SAAS,IAAI;;YACX,IAAI,YAAY,CAAC,oBAAoB;gBAAE,OAAO;YAE9C,YAAY,CAAC,oBAAoB,GAAG,IAAI,CAAC;YACzC,IAAI,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACzC,CAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;YAC3B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;YACf,CAAC,CAAC,GAAG,GAAG,gDAAgD,CAAC;YACzD,CAAC,CAAC,OAAO,GAAG,OAAO,CAAC;YACpB,IAAI,CAAC,GAAG,QAAQ,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YACnD,MAAA,CAAC,CAAC,UAAU,0CAAE,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE;SAClC;QAED,IAAI,QAAQ,CAAC,UAAU,KAAK,UAAU,EAAE;YACtC,IAAI,EAAE,CAAC;SACR;aAAM,IAAI,YAAY,CAAC,WAAW,EAAE;YACnC,YAAY,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;SAC1C;aAAM;YACL,MAAM,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;YACzD,MAAM,CAAC,gBAAgB,CAAC,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;SAC9C;KACF;IAED,6BAAI,GAAJ,UACE,QAAgC,EAChC,QAA4C;QAEpC,IAAA,SAAS,GAAc,MAAiB,UAA/B,CAAgC;QACjD,SAAS,CAAC,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;KACvC;IAED,sCAAa,GAAb;QACU,IAAA,SAAS,GAAc,MAAiB,UAA/B,CAAgC;QACjD,SAAS,CAAC,eAAe,CAAC,CAAC;KAC5B;IAED,sCAAa,GAAb;QACU,IAAA,SAAS,GAAc,MAAiB,UAA/B,CAAgC;QACjD,SAAS,CAAC,eAAe,CAAC,CAAC;KAC5B;IAED,iCAAQ,GAAR,UAAS,MAAc;QACb,IAAA,SAAS,GAAc,MAAiB,UAA/B,CAAgC;QACjD,SAAS,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;KAC/B;IAED,iCAAQ,GAAR;QACU,IAAA,SAAS,GAAc,MAAiB,UAA/B,CAAgC;QACjD,SAAS,CAAC,UAAU,CAAC,CAAC;KACvB;IACH,qBAAC;AAAD,CAAC,IAAA;AAED,YAAe,IAAI,cAAc,EAAE;;;;"}